version: 0.1.0
type: Uniform
spec:
  services:
  # helm-service for everything but production
  - name: helm-service
    image: keptn/helm-service:0.6.0
    actions:
      - deploy_direct
      - deploy_blue_green
    filter:
      - "stage != 'production'"
  
  # helm-service for production
  - name: helm-service-prod
    image: keptn/helm-service:0.6.0
    actions:
      - deploy_direct
      - deploy_blue_green
    filter:
      - "stage == 'production'"
    
  - name: promote-service
    image: keptn/promote-service:0.6.0
    actions:
      - promote
    
  - name: external-security-service
    actions:
      - security_tests
    external: true
    hooks:
      web:
        https://something.com/security/?token=1234

  - name: some-docker-container
    actions:
      - special_tests
    external: true
    hooks:
      docker:
        docker.io/myusername/myimage:1.2.3

  - name: jmeter-service
    image: keptn/jmeter-service:0.6.0
    # required_data:
    #  - uri_to_test      
    actions:
      - functional_tests
      - performance_tests

  # keptn update uniform performance_tests+=neoload
  - name: neoload-service
    image: keptn/neoload-service:0.6.0
    # required_data:
    #  - uri_to_test  
    actions:
      - performance_tests

  # keptn update uniform my_perf_tests+=keptn/neoload-service:0.6.1
  - name: neoload-service2
    image: keptn/neoload-service:0.6.1
    actions:
      - my_perf_tests

  - name: slack-trail
    image: keptn/slack-service:0.1.2
    env:
    - name: SLACK_WEBHOOK
      value: "https://hooks.slack.com/services/TXXXXXXXX/BXXXXXXX/WXXXXXXXXXXXXXXXXX"
    confirms: false # indicates that the service is not critical, and does
                    # send a .done event back
    actions:
      - __ALL__

  - name: mongodb-datastore
    image: keptn/mongodb-service
    confirms: false # indicates that the service is not critical, and does
                    # send a .done event back
    actions:
      - __ALL__


  - name: lighthouse-service
    image: keptn/lighthouse-service
    actions:
      - evaluation
      - evaluate_release
